version: 2

snapshots:
  - name: SNSH_ABC_BANK_POSITION
    columns:
      - name: POSITION_HKEY
        tests:
          - hash_collision_free:
              name: pos_hkey_no_collision
              arguments:
                hashed_fields:
                  - account_code
                  - security_code

      - name: POSITION_HDIFF
        tests:
          - hash_collision_free:
              name: pos_hdiff_no_collision
              arguments:
                hashed_fields:
                  - account_code
                  - security_code
                  - security_name
                  - exchange_code
                  - "to_varchar(report_date, 'YYYY-MM-DD')"
                  - quantity
                  - cost_base
                  - position_value
                  - currency_code
